
# If not running interactively, do nothing
[[ $- != *i* ]] && return

export PATH="/home/rien/.rbenv/bin:/home/rien/Android/Sdk/platform-tools:/home/rien/Development/Android/CM13/bin:/home/rien/scripts/:$PATH"

# Different aliases and inits for servers and clients
if [[ -z "$SSH_CONNECTION" ]]
then
## CLIENT ##

    exec tmux

    # Open stuff
    alias o='xdg-open'

    # Matlab CLI
    alias matlab='/opt/Matlab/bin/matlab -nodesktop -nosplash'

    # Steam
    alias steam="LD_PRELOAD='/usr/\$LIB/libstdc++.so.6 /usr/\$LIB/libgcc_s.so.1 /usr/\$LIB/libxcb.so.1 /usr/\$LIB/libgpg-error.so' /usr/bin/steam > /dev/null 2>&1 &"

    # Clipboard stuff
    alias showclip='xclip -o -sel clip'
    alias paste='xlip -o -sel clip >'
    alias clip='xclip -sel clip <'

    # Zeus
    alias cmuz='PULSE_SERVER=ZEVEN cmus'
    alias cammie='curl http://kelder.zeus.ugent.be/webcam/video/mjpg.cgi | mpv --no-correct-pts --fps 5 -'

    # CPU Commands
    alias watchcpu='watch grep \"cpu MHz\" /proc/cpuinfo'

    alias noturbo='echo 1 | sudo tee /sys/devices/system/cpu/intel_pstate/no_turbo'
    alias turbo='echo 0 | sudo tee /sys/devices/system/cpu/intel_pstate/no_turbo'
    alias powersave='sudo cpupower frequency-set -g powersave && noturbo'
    alias performance='sudo cpupower frequency-set -g performance && turbo'
    alias normal='sudo cpupower frequency-set -g powersave && turbo'

    # Android Debug Bridge
    alias adbrestart='sudo adb kill-server && sudo adb start-server'
    alias adb='sudo adb'

else
## SERVER ##
true

fi
## COMMON ##

#UGent VPN
alias vu='sudo vpnc /root/vpnc.conf'
alias vd='sudo vpnc-disconnect'

# Neovim!
alias vi='nvim'
alias vim='nvim'

# Take a screeshot and upload it to my server
alias shot='bash ~/scripts/shot.sh'
alias shots='shot -s'

# Git
alias gd='git diff'
alias gdc='git diff --cached'
alias gs='git status --short'
alias gsd='git stash && git stash drop'
alias ga='git add -vu'
alias gA='git add -vA'
alias gc='git commit'
alias gcm='git commit -m'
alias gca='git commit -a'
alias gcam='git commit -am'
alias gpp='git pull && git push'
alias gl="git log --graph --abbrev-commit --decorate --date=relative --format=format:'%C(bold blue)%h%C(reset) - %C(bold green)(%ar)%C(reset) %C(white)%s%C(reset) %C(dim white)- %an%C(reset)%C(bold yellow)%d%C(reset)' --all"


#Run these commands in interactive mode:
alias cp='cp -iv'
alias mv='mv -iv'
# Prevents accidentally clobbering files.
alias mkdir='mkdir -p'

# rm: show files to be removed and ask for confirmation once
function irm {
    local args=("$@")
    local recurse=''
    # 'false'
    local i=1
    while [ $i -le ${#args[*]} ] && [ -z $recurse ]
    do
        recurse="$(echo ${args[$i]} | grep '^-.*r')"
        i=$((i+1))
    done
}

# Easier directory jumping
alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
alias .....='cd ../../../..'

# Colored grepping
alias grep='grep --color=auto'
alias egrep='egrep --color=auto'

# Add colors for filetype and  human-readable sizes by default on 'ls':
alias ls='ls -h --color'
alias l='ls -Alhk'         #  Woopwoop
alias lx='ls -lXB'         #  Sort by extension.
alias lk='ls -lSr'         #  Sort by size, biggest last.
alias lt='ls -ltr'         #  Sort by date, most recent last.
alias lc='ls -ltcr'        #  Sort by/show change time,most recent last.
alias lu='ls -ltur'        #  Sort by/show access time,most recent last.

# The ubiquitous 'll': directories first, with alphanumeric sorting:
alias ll="ls -lv --group-directories-first"
alias lm='ll | less'       #  Pipe through 'more'
alias la='ll -A'           #  Show hidden files.

# Human readable sizes for du and df
alias du="du -h"
alias df="df -h"

# Other
alias tree='tree -Csuh'    #  Nice alternative to 'recursive ls' ...
alias lr='tree'            #  Recursive ls
alias bc='bc -l'           #  Always import the standard math library
alias off='sudo poweroff'  #  Don't accidentally shut down severs

# Calculate stuff with bc faster
# Usage: ebc '1 + 1'
function ebc {
    echo $1 | bc -l
}

# Interactive rm function: always show what is going to be removed
function rm {
    local nodes=()
    for arg in "$@"
    do
        if /usr/bin/grep -qv '^-' <<< "$arg"
        then
            nodes+=("$arg")
            if [ -d "$arg" ]
            then
                /usr/bin/tree -Csauh --du "$arg"
            else
                /usr/bin/ls -FCsh "$arg"
            fi
        fi
    done

    # Show total size of the files
    /usr/bin/du -csh ${nodes[@]} | tail -n1

    # Ask confirmation
    echo 'remove[y/N]?' | tr -d '\012'
    read

    if [ "_$REPLY" = "_y" ]
    then
        /bin/rm -rfv $@
    else
        echo '(cancelled)'
    fi
}

# Init some things
eval "$(thefuck --alias)"
eval "$(rbenv init -)"

# Environment variables
export DEFAULT_USER=rien
export EDITOR=/usr/bin/nvim
export TERMINAL=/usr/bin/urxvt
